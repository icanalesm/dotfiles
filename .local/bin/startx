#!/bin/sh

conf_graphics_card()
{
	CONF_FILE_X="/etc/X11/xorg.conf.d/10-nvidia-drm-outputclass.conf"
	case $1 in
		discrete) CONF_FILE="$HOME/.config/X11/xorg.conf.d/10-nvidia-drm-outputclass.conf" ;;
		*)        CONF_FILE="/dev/null" ;;
	esac
	if [ "$(stat -L -c "%d:%i" "$CONF_FILE_X")" != "$(stat -c "%d:%i" "$CONF_FILE")" ]; then
		sudo ln -sf "$CONF_FILE" "$CONF_FILE_X"
	fi
}

conf_graphics_card "$GRAPHICS_CARD"

exec /usr/bin/startx -- -verbose 6 -logverbose 6 1> /tmp/Xout.log 2> /tmp/Xerr.log

