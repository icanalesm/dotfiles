################################################################################
# Server
################################################################################

# Set default $TERM
if-shell "[ \"$TERM\" = \"linux\" ]"\
         "set -g default-terminal \"linux\""\
         "set -g default-terminal \"tmux-256color\""

# Delay between prefix and command
set -g escape-time 1

################################################################################
# Sessions
################################################################################

# Start non-login shell
set -g default-command "/bin/bash --rcfile ${HOME}/.config/bash/bashrc"

# Disable mouse support
set -g mouse off

# Indices for windows start at 1
set -g base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Remap prefix from 'C-b' to 'C-a'
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# Reload tmux configuration 
bind C-r source-file "${HOME}/.config/tmux/tmux.conf" \; display "Configuration reloaded!"

# Create session
bind C new-session

# Rename session
unbind "\$"
bind R command-prompt -I "#{session_name}" "rename-session '%%'"

# Switch sessions
unbind s
unbind (
unbind )
bind S choose-tree -Zs
bind P switch-client -p
bind N switch-client -n

################################################################################
# Windows
################################################################################

# Indices for panes start at 1
set -g pane-base-index 1

# Monitor for activity in windows
set -g monitor-activity on

# Create window
bind c new-window

# Rename window
unbind ,
bind r command-prompt -I "#{window_name}" "rename-window '%%'" 

# Switch windows
unbind w
bind s choose-tree -Zw
bind p previous-window
bind n next-window

# Tiled layout
bind t select-layout tiled

################################################################################
# Panes
################################################################################

# Toggle print to all panes in a window at once
bind a set synchronize-panes

# Create pane
unbind %
bind | split-window -h -c '#{pane_current_path}'
unbind '"'
bind - split-window -v -c '#{pane_current_path}'

# Switch panes
unbind Left
unbind Down
unbind Up
unbind Right
bind -r h select-pane -L
bind -r j select-pane -D
bind -r k select-pane -U
bind -r l select-pane -R

# Resize pane
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Swap pane
unbind '{'
unbind '}'
bind -r < swap-pane -U
bind -r > swap-pane -D

################################################################################
# Copy mode
################################################################################

# Use vi-style key bindings
set -g mode-keys vi

# Vim-style copying
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Search
bind / copy-mode \; send-key ?

################################################################################
# Colour theme and status bar
################################################################################

# Colour scheme: Base16 Default Dark
#                (https://github.com/chriskempson/base16-default-schemes)
# Colour scheme author: Chris Kempson
#base00="#181818"  # Black
base01="#282828"  # Darkest Grey
base02="#383838"  # Dark Grey
#base03="#585858"  # Grey (Bright Black)
base04="#B8B8B8"  # Light Grey
base05="#D8D8D8"  # White
#base06="#E8E8E8"  # Lighter White
#base07="#F8F8F8"  # Bright White
#base08="#AB4642"  # Red
#base09="#DC9656"  # Orange
#base0A="#F7CA88"  # Yellow
#base0B="#A1B56C"  # Green
#base0C="#86C1B9"  # Cyan
base0D="#7CAFC2"  # Blue
base0E="#BA8BAF"  # Magenta
#base0F="#A16946"  # Brown

set -g message-style "fg=${base01},bg=${base04}"
set -g message-command-style "fg=${base01},bg=${base04}"

set -g mode-style "fg=${base05},bg=${base02}"

set -g pane-border-style "fg=${base01}"
set -g pane-active-border-style "fg=${base04}"

set -g status on
set -g status-interval 0
set -g status-justify left
set -g status-position bottom
set -g status-style "fg=${base04},bg=${base01}"

set -g status-left ""
set -g status-left-length 0

set -g status-right " #{?client_prefix,#[fg=${base01}]#[bg=${base0E}],} #S @ #H "
set -g status-right-length 50

set -g window-status-activity-style "fg=${base01},bg=${base04}"
set -g window-status-bell-style "fg=${base01},bg=${base0E}"
set -g window-status-separator ""
set -g window-status-format " #I:#{?window_zoomed_flag,[Z],}#W "
set -g window-status-current-format " #[fg=${base0D}]#I:#{?window_zoomed_flag,[Z],}#W "

